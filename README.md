# AI-Консультант на Streamlit Cloud

Интерактивное веб-приложение для поиска и получения ответов на основе базы знаний с использованием моделей OpenAI и векторного поиска FAISS, развернутое на платформе Streamlit Cloud.

Репозиторий проекта: https://github.com/zsfreee/Interface-for-Faiss-v2

## Обзор

AI-Консультант - это Streamlit-приложение, разработанное для:

- Поиска информации в базе знаний с использованием векторного поиска FAISS
- Генерации ответов с помощью моделей OpenAI (gpt-4o-mini, gpt-4o, gpt-4.1)
- Поддержки контекстных диалогов с сохранением истории разговора
- Работы в трех режимах точности: Строгий, Сбалансированный и Гибкий

## Развертывание на Streamlit Cloud

### Предварительные требования

- Аккаунт GitHub (вы можете форкнуть оригинальный репозиторий)
- Аккаунт на Streamlit Cloud
- Аккаунт OpenAI с API-ключом
- База знаний в формате FAISS (файлы index.faiss и index.pkl)

### Шаги по развертыванию

1. Форкните репозиторий или клонируйте его и загрузите в свой GitHub:

```bash
git clone https://github.com/zsfreee/Interface-for-Faiss-v2.git
cd Interface-for-Faiss-v2
# Внесите необходимые изменения
git add .
git commit -m "Initial commit"
git push origin main
```

2. Зарегистрируйтесь или войдите на Streamlit Cloud
3. Нажмите "New app" и подключите свой GitHub репозиторий
4. Выберите ветку (обычно main) и укажите путь к основному файлу приложения (app.py)
5. В разделе "Advanced settings" добавьте секреты в формате TOML:

```toml
OPENAI_API_KEY = "your_openai_api_key"
PASSWORD = "your_access_password"
```

6. Нажмите "Deploy" и дождитесь завершения процесса развертывания

### Настройка секретов

На Streamlit Cloud все секреты и API-ключи хранятся в формате TOML. Для настройки:

1. После создания приложения, перейдите в раздел "App settings"
2. Выберите вкладку "Secrets"
3. Добавьте следующие секреты в формате TOML:

```toml
OPENAI_API_KEY = "your_openai_api_key"
PASSWORD = "your_access_password"
```

4. Нажмите "Save"

Эти секреты будут доступны в приложении через st.secrets:
```python
api_key = st.secrets.get("OPENAI_API_KEY")
password = st.secrets.get("PASSWORD")
```

## Загрузка базы знаний

Приложение поддерживает два способа загрузки базы знаний FAISS:

### Загрузка с локального компьютера:

- Загрузите файлы index.faiss и index.pkl через интерфейс

### Загрузка с Google Drive:

1. Поделитесь файлами или папкой в Google Drive
2. Скопируйте прямую ссылку
3. Вставьте ссылку в соответствующее поле в боковой панели
4. Нажмите "Загрузить с Google Drive"

## Функции приложения

### Режимы работы

Приложение поддерживает три режима работы с базой знаний:

#### Строгий режим:

- Отвечает ИСКЛЮЧИТЕЛЬНО на основе информации из базы знаний
- При отсутствии информации в базе прямо сообщает об этом
- Не использует внешние знания, даже для простых вопросов
- Приоритет точности над полнотой

#### Сбалансированный режим:

- Приоритет информации из базы знаний
- Дополняет ответы общими знаниями при необходимости
- Четко отмечает, какая информация взята из базы, а какая дополнена
- Баланс между точностью и полнотой

#### Гибкий режим:

- Использует информацию из базы как основу, но свободно дополняет её
- Максимальная полезность ответа для пользователя
- Даже при отсутствии информации в базе старается дать полезный ответ

### Настройки генерации

В боковой панели доступны расширенные настройки:

- Выбор модели: gpt-4o-mini, gpt-4o, gpt-4.1
- Температура генерации: от 0.0 (более детерминированные ответы) до 2.0 (более творческие)
- Максимальное число токенов: ограничение длины ответа
- Число блоков контекста: количество документов из базы для поиска

### Дополнительные функции

- История разговора: Приложение сохраняет контекст диалога для уточняющих вопросов
- Экспорт диалога: Возможность сохранить историю чата в текстовый файл
- Индикатор релевантности: Визуальный показатель точности соответствия ответа базе знаний
- Очистка истории: Возможность начать диалог заново
- Защита паролем: Доступ к приложению только для авторизованных пользователей

## Практические советы

### Оптимизация requirements.txt

```
streamlit>=1.30.0
streamlit-extras
langchain-community
langchain-openai
openai
gdown
faiss-cpu
matplotlib
numpy
```

### Типичные проблемы и решения

#### Ошибка при загрузке файлов из Google Drive:

- Убедитесь, что файлы доступны по ссылке для всех, у кого есть URL
- Используйте URL с префиксом https://drive.google.com/file/d/

#### Превышение лимитов API OpenAI:

- Установите более низкую частоту запросов
- Рассмотрите возможность использования менее дорогих моделей (gpt-4o-mini)

#### Медленная загрузка базы знаний:

- Разделите базу на более мелкие компоненты
- Используйте кэширование ранее загруженных баз

## Лицензия

Этот проект распространяется под лицензией MIT. 